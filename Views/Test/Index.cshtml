@{
    ViewData["Title"] = "API Test";
}

<div class="main-container">
    <div class="section-header">
        <h1 class="section-title">ğŸ§ª T-Soft API V3 Test</h1>
        <button class="btn btn-primary" onclick="location.reload()">
            ğŸ”„ Yeniden Test Et
        </button>
    </div>

    <!-- Test Logs -->
    <div class="cards-container">
        <h3 style="margin-bottom: 16px; font-size: 18px;">ğŸ“‹ Test SonuÃ§larÄ±</h3>
        
        <div style="background: var(--bg-main); border: 1px solid var(--border); border-radius: 12px; padding: 24px; font-family: 'Courier New', monospace; font-size: 14px; line-height: 1.8;">
            @foreach (var log in (List<string>)ViewBag.Logs)
            {
                if (log.StartsWith("âœ…") || log.StartsWith("ğŸ”") || log.StartsWith("ğŸ“¦") || log.StartsWith("ğŸ“"))
                {
                    <div style="color: var(--success);">@log</div>
                }
                else if (log.StartsWith("âŒ") || log.StartsWith("ğŸ’¥"))
                {
                    <div style="color: var(--danger); font-weight: bold;">@log</div>
                }
                else if (log.Contains("â”"))
                {
                    <div style="color: var(--text-secondary);">@log</div>
                }
                else
                {
                    <div style="color: var(--text-primary);">@log</div>
                }
            }
        </div>
    </div>

    <!-- DetaylÄ± Debug Bilgisi -->
    <div class="cards-container" style="margin-top: 24px;">
        <h3 style="margin-bottom: 16px; font-size: 18px;">ğŸ” DetaylÄ± Bilgi</h3>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
            <!-- Products JSON -->
            <div>
                <h4 style="color: var(--primary); margin-bottom: 12px;">ğŸ“¦ Products Response</h4>
                <div style="background: var(--bg-main); border: 1px solid var(--border); border-radius: 8px; padding: 16px; max-height: 400px; overflow-y: auto;">
                    <pre style="margin: 0; color: var(--text-secondary); font-size: 12px; white-space: pre-wrap; word-wrap: break-word;">@System.Text.Json.JsonSerializer.Serialize(ViewBag.ProductsResult, new System.Text.Json.JsonSerializerOptions { WriteIndented = true })</pre>
                </div>
            </div>

            <!-- Categories JSON -->
            <div>
                <h4 style="color: var(--success); margin-bottom: 12px;">ğŸ“ Categories Response</h4>
                <div style="background: var(--bg-main); border: 1px solid var(--border); border-radius: 8px; padding: 16px; max-height: 400px; overflow-y: auto;">
                    <pre style="margin: 0; color: var(--text-secondary); font-size: 12px; white-space: pre-wrap; word-wrap: break-word;">@System.Text.Json.JsonSerializer.Serialize(ViewBag.CategoriesResult, new System.Text.Json.JsonSerializerOptions { WriteIndented = true })</pre>
                </div>
            </div>

            <!-- Orders JSON -->
            <div>
                <h4 style="color: var(--warning); margin-bottom: 12px;">ğŸ›’ Orders Response</h4>
                <div style="background: var(--bg-main); border: 1px solid var(--border); border-radius: 8px; padding: 16px; max-height: 400px; overflow-y: auto;">
                    <pre style="margin: 0; color: var(--text-secondary); font-size: 12px; white-space: pre-wrap; word-wrap: break-word;">@System.Text.Json.JsonSerializer.Serialize(ViewBag.OrdersResult, new System.Text.Json.JsonSerializerOptions { WriteIndented = true })</pre>
                </div>
            </div>
        </div>
    </div>

    <!-- YardÄ±m -->
    <div class="cards-container" style="margin-top: 24px;">
        <h3 style="margin-bottom: 16px; font-size: 18px;">ğŸ’¡ Ne YapmalÄ±yÄ±m?</h3>
        
        <div style="display: flex; flex-direction: column; gap: 16px;">
            <div class="alert alert-info">
                <strong>âœ… EÄŸer "Success: True" gÃ¶rÃ¼yorsan:</strong><br>
                API Ã§alÄ±ÅŸÄ±yor! ÃœrÃ¼nler sayfasÄ±na git: <a href="/Products" style="color: var(--primary); text-decoration: underline;">ÃœrÃ¼nler</a>
            </div>

            <div class="alert alert-danger">
                <strong>âŒ EÄŸer hata gÃ¶rÃ¼yorsan:</strong><br>
                1. Token'Ä±nÄ±n doÄŸru olduÄŸundan emin ol (appsettings.json)<br>
                2. V3 API endpoint'lerinin doÄŸru olduÄŸunu kontrol et<br>
                3. Visual Studio Output penceresinde detaylÄ± loglarÄ± incele (View â†’ Output)
            </div>

            <div style="background: var(--bg-main); border: 1px solid var(--border); border-radius: 8px; padding: 16px;">
                <strong style="color: var(--warning);">ğŸ” Debug Ä°puÃ§larÄ±:</strong><br><br>
                â€¢ <strong>401 Unauthorized:</strong> Token geÃ§ersiz veya eksik<br>
                â€¢ <strong>404 Not Found:</strong> Endpoint yanlÄ±ÅŸ<br>
                â€¢ <strong>500 Server Error:</strong> API sunucu hatasÄ±<br>
                â€¢ <strong>JSON Parse Error:</strong> Response formatÄ± beklenenden farklÄ±
            </div>
        </div>
    </div>
</div>
